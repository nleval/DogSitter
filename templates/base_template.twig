<!DOCTYPE html>
<html lang="fr">
<head>
    {% block head %}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&family=Montserrat:wght@500;700&display=swap" rel="stylesheet">

    <!-- Bootstrap CSS  -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <link rel="stylesheet" href="css/style.css?v=1.2">

    {% block css %}{% endblock %}
    <title>{% block title %}DogSitter{% endblock %}</title>
    {% endblock %}
</head>
<body>

<div class="container-fluid px-0">

    <!-- HEADER -->
    <header class="row">
        <nav class="navbar navbar-expand-lg navbar-custom shadow-sm px-3 rounded-bottom-4">
            <div class="container-fluid">

                <!-- Logo -->
                <a class="navbar-brand d-flex align-items-center" href="index.php">
                    <img src="images/logo_dogsitter.png" alt="Logo DogSitter" class="logo-dog me-2">
                    DogSitter
                </a>

                <!-- Navbar -->
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                        data-bs-target="#navbarSupportedContent"
                        aria-controls="navbarSupportedContent" aria-expanded="false"
                            aria-label="Basculer la navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="collapse navbar-collapse" id="navbarSupportedContent">


                    {# Barre de recherche #}
                    <div class="search-center mx-auto d-flex align-items-center">
                        <form class="w-100" onsubmit="return false;">
                            <div class="input-group">
                                <input id="headerSearch" list="headerSearchOptions" class="form-control header-search" placeholder="Rechercher (ex : regarder les annonces, poster une annonce)" aria-label="Recherche rapide" autocomplete="off">
                                <datalist id="headerSearchOptions">
                                    <option value="Regarder les annonces" data-url="index.php?controleur=annonce&methode=afficherAllAnnonces"></option>
                                    <option value="Poster une annonce" data-url="poster_annonce.php"></option>
                                </datalist>
                                <button id="headerSearchBtn" class="btn btn-search-action" type="button" aria-label="Valider la recherche">Recherche</button>
                            </div>
                        </form>
                    </div>

                    {# Icônes à droite : messages et connexion #}
                    <ul class="navbar-nav ms-auto mb-2 mb-lg-0 d-flex align-items-center">

                            <li class="nav-item me-2">
                                <a class="nav-link link-msg" href="index.php?controleur=conversation&methode=afficherAllConversation" aria-label="Messages">
                                    <!-- SVG messages -->
                                    <svg class="msg-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                                        <path fill="currentColor" d="M20 2H4c-1.1 0-2 .9-2 2v14l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/>
                                    </svg>
                                    <span class="visually-hidden">Messages</span>
                                </a>
                            </li>

                            <li class="nav-item">
                                <a class="nav-link {% if menu=='auth' %}active{% endif %} d-flex align-items-center" href="index.php?controleur=utilisateur&methode=afficherUtilisateur" aria-label="Se connecter ou créer un compte">
                                    <!-- SVG utilisateur -->
                                    <svg class="auth-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
                                        <path fill="currentColor" d="M12 2a5 5 0 1 1 0 10a5 5 0 0 1 0-10zm0 12c4.418 0 8 1.79 8 4v2H4v-2c0-2.21 3.582-4 8-4z"/>
                                    </svg>
                                    <span class="visually-hidden">Se connecter / S'inscrire</span>
                                </a>
                            </li>
                        </ul>

                    </div>
            </div>
        </nav>
    </header>

    <!-- CONTENT -->
    {% block content %}{% endblock %}

    <!-- FOOTER -->
    <footer class="text-center py-4 mt-5 shadow-sm">
        <p class="mb-1">&copy; {{ "now"|date("Y") }} DogSitter. Tous droits réservés.</p>
        <p class="mb-0">
            <a href="confidentialité.php">Politique de confidentialité</a> |
            <a href="conditionUtilisation.php">Conditions d'utilisation</a>
        </p>
    </footer>

    {% block script %}{% endblock %}
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
// petite logique pour rediriger selon le choix dans la datalist ou le texte saisi
(function(){
    var input = document.getElementById('headerSearch');
    var btn = document.getElementById('headerSearchBtn');
    function goTo(value){
        if(!value) return;
        var opts = document.querySelectorAll('#headerSearchOptions option');
        for(var i=0;i<opts.length;i++){
            if(opts[i].value === value){
                var url = opts[i].getAttribute('data-url');
                if(url){ window.location.href = url; return; }
            }
        }
        var v = value.toLowerCase();
        for(var j=0;j<opts.length;j++){
            if(opts[j].value.toLowerCase().indexOf(v) !== -1){
                var u = opts[j].getAttribute('data-url');
                if(u){ window.location.href = u; return; }
            }
        }
    }
    if(input){
        input.addEventListener('keydown', function(e){
            if(e.key === 'Enter'){
                e.preventDefault();
                goTo(this.value);
            }
        });
    }
    if(btn){ btn.addEventListener('click', function(){ goTo(input.value); }); }
})();
</script>

</body>
</html>

{% extends 'base_template.twig' %}

{% block title %}Avis - {{ utilisateur.pseudo }} — DogSitter{% endblock %}

{% block content %}
<div style="background-color: #FEFAE0; min-height: 100vh; padding: 40px 20px;">
    <div style="max-width: 1000px; margin: 0 auto;">
        
        <!-- Header avec infos promeneur -->
        <div style="background: linear-gradient(135deg, #537031 0%, #4a5f28 100%); padding: 40px; border-radius: 12px; margin-bottom: 40px; box-shadow: 0 4px 16px rgba(83, 112, 49, 0.15); display: flex; align-items: center; gap: 30px; flex-wrap: wrap;">
            
            <!-- Photo + infos -->
            <div style="display: flex; align-items: center; gap: 20px; flex: 1; min-width: 250px;">
                {% if utilisateur.photoProfil is not empty %}
                    <img src="images/utilisateur/{{ utilisateur.photoProfil }}" alt="{{ utilisateur.pseudo }}" style="width: 80px; height: 80px; border-radius: 50%; object-fit: cover; border: 4px solid #FEFAE0; box-shadow: 0 2px 8px rgba(0,0,0,0.15);">
                {% else %}
                    <div style="width: 80px; height: 80px; border-radius: 50%; background-color: #9AAD5A; display: flex; align-items: center; justify-content: center; border: 4px solid #FEFAE0;">
                        <i class="bi bi-person" style="font-size: 40px; color: #FEFAE0;"></i>
                    </div>
                {% endif %}
                
                <div>
                    <h1 style="color: #FEFAE0; margin: 0 0 5px 0; font-size: 28px; font-weight: 600;">{{ utilisateur.pseudo }}</h1>
                    <p style="color: rgba(254, 250, 224, 0.8); margin: 0; font-size: 14px;">
                        <i class="bi bi-person-walking" style="color: #DDA15E;"></i> Promeneur
                    </p>
                </div>
            </div>

            <!-- Statistiques -->
            <div style="text-align: center; background-color: rgba(255, 255, 255, 0.1); padding: 20px 30px; border-radius: 8px; backdrop-filter: blur(10px);">
                <div style="font-size: 32px; font-weight: 700; color: #DDA15E; margin-bottom: 5px;">
                    <i class="bi bi-star-fill"></i> {{ stats.moyenne|number_format(1, '.', '') }}/5
                </div>
                <p style="color: #FEFAE0; margin: 0; font-size: 13px;">{{ stats.total }} avis{{ stats.total != 1 ? 's' : '' }}</p>
            </div>
        </div>

        <!-- Avis -->
        {% if avis|length > 0 %}
            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px;">
                {% for review in avis %}
                    <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 2px 12px rgba(83, 112, 49, 0.08); border-left: 4px solid #DDA15E; transition: all 0.3s ease; hover:box-shadow: 0 4px 20px rgba(83, 112, 49, 0.15);" onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='0 4px 20px rgba(83, 112, 49, 0.15)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 12px rgba(83, 112, 49, 0.08)'">
                        
                        <!-- En-tête avis -->
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 15px;">
                            <div style="display: flex; align-items: center; gap: 12px; flex: 1;">
                                {% if review.auteur and review.auteur.photoProfil %}
                                    <img src="images/utilisateur/{{ review.auteur.photoProfil }}" alt="{{ review.auteur.pseudo }}" style="width: 40px; height: 40px; border-radius: 50%; object-fit: cover;">
                                {% else %}
                                    <div style="width: 40px; height: 40px; border-radius: 50%; background-color: #9AAD5A; display: flex; align-items: center; justify-content: center;">
                                        <i class="bi bi-person" style="color: #FEFAE0;"></i>
                                    </div>
                                {% endif %}
                                <div>
                                    {% if review.auteur %}
                                        <p style="margin: 0; font-weight: 600; color: #537031;">{{ review.auteur.pseudo }}</p>
                                    {% else %}
                                        <p style="margin: 0; font-weight: 600; color: #537031;">Utilisateur</p>
                                    {% endif %}
                                </div>
                            </div>
                            <div style="display: flex; gap: 3px; align-items: center;">
                                {% for i in 1..5 %}
                                    {% if i <= review.getNote %}
                                        <i class="bi bi-star-fill" style="color: #DDA15E; font-size: 16px;"></i>
                                    {% else %}
                                        <i class="bi bi-star" style="color: #ddd; font-size: 16px;"></i>
                                    {% endif %}
                                {% endfor %}
                            </div>
                        </div>

                        <!-- Texte de l'avis -->
                        <p style="color: #666; margin: 0 0 12px 0; font-size: 14px; line-height: 1.5; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; text-overflow: ellipsis;">{{ review.getTexteCommentaire }}</p>

                        <!-- Date -->
                        <p style="color: #aaa; margin: 0; font-size: 12px;">
                            <i class="bi bi-calendar-event"></i> Avis récent
                        </p>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <div style="background: white; border-radius: 12px; padding: 60px 40px; text-align: center; box-shadow: 0 2px 12px rgba(83, 112, 49, 0.08);">
                <i class="bi bi-chat-left-quote" style="font-size: 48px; color: #ddd; margin-bottom: 20px; display: block;"></i>
                <h3 style="color: #537031; margin: 0 0 10px 0;">Aucun avis pour le moment</h3>
                <p style="color: #999; margin: 0;">{{ utilisateur.pseudo }} n'a pas encore reçu d'avis.</p>
            </div>
        {% endif %}

        <!-- Bouton retour -->
        <div style="margin-top: 40px; text-align: center;">
            <a href="javascript:history.back()" style="display: inline-flex; align-items: center; gap: 8px; background-color: #537031; color: #FEFAE0; padding: 12px 24px; border-radius: 6px; text-decoration: none; font-weight: 600; transition: all 0.3s ease;" onmouseover="this.style.backgroundColor='#4a5f28'; this.style.transform='translateX(-4px)'" onmouseout="this.style.backgroundColor='#537031'; this.style.transform='translateX(0)'">
                <i class="bi bi-arrow-left"></i> Retour
            </a>
        </div>

    </div>
</div>
{% endblock %}
